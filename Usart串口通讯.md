### 串口通讯笔记（全双工传输）



### 串口通讯理论：



#### 串口配置的重要参数

1. **波特率**（串口的通讯速率）
2. **空闲状态**（一般为高电平）
3. **起始位**  ，标志一个数据帧的开始，固定为低电平，当数据开始发送时，从高电平空闲状态，产生一个下降沿，转为低电平
4. **数据位**  发送数据 ，1 为 高电平 ， 0 为低电平 。**低位先行** 比如 发送数据帧0x0F 在数据帧里就是低位线性 即 1111 0000
5. **校验位** 用于数据验证，  分为奇校验和偶校验，以及无校验
6. **停止位** 用于数据间隔，固定高电平，数据发送完成产生高电平


![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/1c238186f5d84481fcbdff889a58d591.png)



### 串口发送以及接受数据



#### **1. 串口发送（即从stm32芯片内部发送数据到外部设备）**



![image-20240913151224807](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240913151224807.png)

配置串口参数时候，可以选择发送数据帧的数据位的大小，可选择8位或者9位

**串口发送实际上是对  TDR 寄存器进行操作**

1. 当串口发送数据时，**会检测发送移位寄存器是不是又数据正在发生移位，如果没有移位，那么这个数据就会立刻转移到发送移位寄存器。准备发送**

2. 当数据**全部移动**到移位寄存器时，会产生一个 **TXE** 置为1 产生中断

   

   ![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/6262a9d1aa02ada1eeb1608228413073.png)

------



#### 2. 串口接受（Stm32芯片接受外部电信号）

![image-20240913152719418](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240913152719418.png)

1. 串口接受数据时，数据从 **RX引脚** 通向 **接受移位寄存器**， 在接受控制下，一位一位读取 **RX** 的 电平 ，把第一位放在最高位

​         然后 右移 ，移位8次就接收到一个字节了

    2. **当整个字节数据移位完成后**， 这个字节数据就会 **整体的** 移动到 **RDR（接受数据寄存器），触发RXNE 置位1**



![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/42680dfa3d959a8c83cfb969e65a9b42.png)



------

